steps:

# Analyze Azure resources using PSRule for Azure

#- task: ps-rule-assert@2
 # displayName: Analyze Azure template files
  #continueOnError: true
  #inputs:
   # modules: 'PSRule.Rules.Azure'
    #inputPath: code-test/
    #baseline: Azure.All
    #outputFormat: Sarif
    #outputPath: output/ps-rule-results.sarif 

- task: PowerShell@2
  displayName: 'Run PSRule'
  continueOnError: true
  inputs:
    targetType: 'inline'
    script: |
     # Install-Module -Name Az.Accounts -Scope CurrentUser -Force -AllowClobbe
     # Import-Module -name Az.Accounts
     # Update-Module -Name Az
      write-host "script start"
      Install-Module -Name 'PSRule.Rules.Azure' -Repository PSGallery -Force -Scope AllUsers
      write-host "module should be installed"
      Export-AzRuleData -Subscription 'Test'
      write-host "data exported"
      
      
    
